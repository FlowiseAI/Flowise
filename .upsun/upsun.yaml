applications:
  - name: flowise-app
    type: "nodejs:18"  # Specify the Node.js runtime version
    
    build:
      flavor: none  # Disable the default npm build

    hooks:
      build: |
        # Install Yarn globally
        npm install -g yarn@1.22.19
        # Clear Yarn's registry cache to ensure the correct settings are applied
        yarn config delete registry
        # Set the Yarn registry explicitly to avoid any issues
        yarn config set registry https://registry.yarnpkg.com
        # Use Yarn to install dependencies without creating or modifying the lockfile
        yarn install --frozen-lockfile

      deploy: |
        # Use Yarn to build the application
        yarn build

    web:
      commands:
        start: "yarn start"

routes:
  "https://{default}/":
    type: upstream
    upstream: flowise-app:http

